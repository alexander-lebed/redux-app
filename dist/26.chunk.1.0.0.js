(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{190:function(e,t,r){"use strict";r.r(t),function(e){var t=r(9),n=r.n(t),o=r(21),a=r.n(o),u=r(20),c=r.n(u),s=r(824),i=r.n(s),l=r(528),p=r(113),f=r(18),d=r.n(f),m=r(526),h=r.n(m),w=r(10),b=r(22);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach(function(t){c()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}e.WebSocket=l.WebSocket,jest.mock("hellojs",function(){return{use:function(){return{api:function(){return{id:"12345",first_name:"FirstName",email:"newname@email.com",thumbnail:"/images/default-profile.jpg"}},login:function(){return Promise.resolve(!0)},logout:function(){return Promise.resolve(!0)}}}}});var g=[p.a],v=i()(g);describe("Authentication reducer",function(){var e=function(){return x({},{_id:"111",username:"Current User",email:"user@mail.com",password:"user-password",online:!1,lastTime:1519294933743,oauth:""},{},{online:!0})},t="".concat(w.USERS_URL,"/").concat("111"),r={authentication:{user:null},users:{users:[{_id:"111",username:"Current User",email:"user@mail.com",password:"user-password",online:!1,lastTime:1519294933743,oauth:""},{_id:"222",username:"Alice",email:"alice@gmail.com",password:"alice-password",online:!0,lastTime:1518346740388,oauth:""},{_id:"333",username:"Bob",email:"bob@mail.com",password:"bob-password",online:!0,lastTime:1518346740388,oauth:"facebook"}]}},o=new h.a(d.a),u=v(r);afterEach(function(){u.clearActions()}),test("check initial state",a()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:expect(Object(b.default)(void 0,{})).toEqual(r.authentication);case 1:case"end":return e.stop()}},e)}))),test("should login existing user",a()(n.a.mark(function r(){var a,c,s;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o.onPut(t).reply(200,e()),a={type:"SET_USER",payload:e()},c=[a],r.next=5,u.dispatch(Object(b.login)({email:e().email,password:e().password,oauth:e().oauth}));case 5:s=r.sent,expect(s).toBe(!0),expect(u.getActions()).toEqual(c),expect(Object(b.default)({},a)).toEqual({user:e()});case 9:case"end":return r.stop()}},r)}))),test("should login new OAUTH user",a()(n.a.mark(function e(){var t,r,a,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={_id:"3132333435xxxxxxxxxxxxxx",username:"New Name",email:"newname@email.com",password:"",online:!0,pictureUrl:"/images/default-profile.jpg",lastTime:null,oauth:"google"},o.onPut("".concat(w.USERS_URL,"/").concat(t._id)).reply(200,t),a=[r={type:"SET_USER",payload:t}],e.next=6,u.dispatch(Object(b.login)({oauth:t.oauth}));case 6:c=e.sent,expect(c).toBe(!0),expect(u.getActions()).toEqual(a),expect(Object(b.default)({},r)).toEqual({user:t});case 10:case"end":return e.stop()}},e)}))),test("should login existing OAUTH user",a()(n.a.mark(function e(){var t,a,c,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){return r.users.users[2]},o.onPut("".concat(w.USERS_URL,"/").concat(t()._id)).reply(200,t()),a={type:"SET_USER",payload:t()},c=[a],e.next=6,u.dispatch(Object(b.login)(t()));case 6:s=e.sent,expect(s).toBe(!0),expect(u.getActions()).toEqual(c),expect(Object(b.default)({},a)).toEqual({user:t()});case 10:case"end":return e.stop()}},e)}))),test("should go user offline",a()(n.a.mark(function a(){var c,s;return n.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=v(x({},r,{},{authentication:{user:e()}})),o.onPut(t).reply(200,{_id:"111",username:"Current User",email:"user@mail.com",password:"user-password",online:!1,lastTime:1519294933743,oauth:""}),s=[c={type:"SET_USER",payload:{_id:"111",username:"Current User",email:"user@mail.com",password:"user-password",online:!1,lastTime:1519294933743,oauth:""}}],n.next=6,u.dispatch(Object(b.online)(!1));case 6:expect(u.getActions()).toEqual(s),expect(Object(b.default)({},c)).toEqual({user:{_id:"111",username:"Current User",email:"user@mail.com",password:"user-password",online:!1,lastTime:1519294933743,oauth:""}});case 8:case"end":return n.stop()}},a)}))),test("should logout user",a()(n.a.mark(function e(){var r,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.onPut(t).reply(200,{_id:"111",username:"Current User",email:"user@mail.com",password:"user-password",online:!1,lastTime:1519294933743,oauth:""}),a=[r={type:"SET_USER",payload:null}],e.next=5,u.dispatch(Object(b.logout)());case 5:expect(u.getActions()).toEqual(a),expect(Object(b.default)({},r)).toEqual({user:null});case 7:case"end":return e.stop()}},e)}))),test("should logout OAUTH user",a()(n.a.mark(function e(){var t,a,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=v(x({},r,{},{authentication:{user:(t=function(){return r.users.users[2]})()}})),o.onPut("".concat(w.USERS_URL,"/").concat(t()._id)).reply(200,t()),c=[a={type:"SET_USER",payload:null}],e.next=7,u.dispatch(Object(b.logout)());case 7:expect(u.getActions()).toEqual(c),expect(Object(b.default)({},a)).toEqual({user:null});case 9:case"end":return e.stop()}},e)})))})}.call(this,r(31))},824:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function r(){var e=[],r=[],n={getState:function(){return s(t)?t(e):t},getActions:function(){return e},dispatch:function(t){if(!(0,u.default)(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant? Action: '+JSON.stringify(t));e.push(t);for(var n=0;n<r.length;n++)r[n]();return t},clearActions:function(){e=[]},subscribe:function(e){return s(e)&&r.push(e),function(){var t=r.indexOf(e);t<0||r.splice(t,1)}},replaceReducer:function(e){if(!s(e))throw new Error("Expected the nextReducer to be a function.")}};return n}var n=o.applyMiddleware.apply(void 0,c(e))(r);return n()}};var n,o=r(19),a=r(825),u=(n=a)&&n.__esModule?n:{default:n};function c(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var s=function(e){return"function"==typeof e}},825:function(e,t){var r="[object Object]";var n,o,a=Function.prototype,u=Object.prototype,c=a.toString,s=u.hasOwnProperty,i=c.call(Object),l=u.toString,p=(n=Object.getPrototypeOf,o=Object,function(e){return n(o(e))});e.exports=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||l.call(e)!=r||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=p(e);if(null===t)return!0;var n=s.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==i}}}]);